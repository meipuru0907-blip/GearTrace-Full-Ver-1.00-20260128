# GearTrace Project Status & History

## 🚀 実装済み機能 (Implemented Features)

現在のGearTraceアプリケーション（Web版）に実装されている機能一覧です。

### 1. ダッシュボード (Dashboard)
- **資産概要表示**:
  - 総資産価値 (Total Asset Value): 全機材の「単価 × 数量」の合計金額を表示。
  - ランニングコスト分析: 月間および年間のサブスクリプションコスト概算を表示。
  - アイテム数等の基本メトリクス表示。
- **検索・フィルター**:
  - キーワード検索（モデル名、メーカー、カテゴリー）。
  - カテゴリー別フィルター。
  - ステータスフィルター（稼働中、故障、メンテナンス中など）。
- **表示モード**:
  - グリッド表示、リスト表示、詳細表示の切り替え。

### 2. 機材管理 (Gear Management)
- **機材登録・編集 (CRUD)**:
  - 基本情報（メーカー、モデル、カテゴリ、シリアル番号、色タグ）。
  - **資産情報**: 購入日、**単価 (Unit Price)**、耐用年数。
  - **数量管理**: 在庫数 (`quantity`) の管理。
  - **ステータス管理**: 機材の状態（Available, Utility, Broken等）の管理。
  - **分割機能**: 複数個ある機材を、ステータスごとに分割して管理する機能。
  - コンテナ（ケース）への紐付け機能。
- **機材詳細 (Detail View)**:
  - **減価償却状況**: 現在の資産価値を表示するコンパクトカード。
  - **相場リサーチ**: Reverb, eBay, メルカリ等の検索リンク自動生成。
  - **売却アシスタント (Resale Assistant)**:
    - 出品用説明テキストの自動生成。
    - **付属品管理**: 元箱、ケーブル等の付属品有無をチェックし、テキスト/PDFに反映。
    - **PDF出力**: 店舗持ち込み用の売却シート作成。

### 3. サブスクリプション管理 (Subscriptions)
- **契約管理**:
  - サービス名、カテゴリ（自由入力）、金額の登録。
- **サイクル管理**: 
  - **月額 (Monthly) / 年額 (Yearly)** の選択。
  - 開始日に基づく**次回支払日の自動計算**。
- **コスト分析**: 月額・年額換算でのトータルコスト表示。

### 4. 設定・データ・サポート (Settings)
- **データエクスポート**:
  - **資産台帳 (Excel)**: 全機材データのExcel出力。
  - **確定申告用データ**: 税務処理用の形式で出力。
  - **JSONバックアップ**: アプリケーションデータのフルバックアップと復元。
- **サポート**:
  - **耐用年数ガイド**: リファレンス用Excelファイルのダウンロード。
  - **バグ報告・要望**: Googleフォームと連携したフィードバック送信機能（システム情報自動付与）。

---

## 📅 実装予定・検討中の機能 (Roadmap & Future)

現状のコードベースと会話履歴から推測される、または今後推奨される機能です。

- [ ] **認証・同期の完全化**:
  - 現状は `Supabase` と `Dexie (Local DB)` が混在している構成の調整。
  - 複数デバイス間でのリアルタイム同期の安定化。
- [ ] **モバイルアプリ最適化 (PWA)**:
  - スマートフォンでのカメラ活用（バーコード/QRスキャンによる機材管理）。
  - オフライン動作の強化。
- [ ] **高度な分析レポート**:
  - カテゴリごとの資産割合チャート。
  - 年間の機材購入額推移グラフ。
- [ ] **貸出管理 (Rental/Loan)**:
  - 「誰に」「いつまで」貸しているかの管理機能（現在の持ち出しリストの拡張）。

---

## 📝 変更履歴詳細 (Detailed Changelog)

これまでの開発プロセスにおける主要な変更点を、新しい順に記載します。

### Ver 1.1.0 - UI改善とロジック修正 (2026-01-29)
*   **数量・資産ロジックの修正**:
    *   `Dashboard.tsx`: 総資産価値の計算ロジックを「購入価格の合計」から「単価 × 数量の合計」に変更。
    *   `DashboardMetricCard.tsx`: 値 (`value`) と補足情報 (`subValue`) を受け取れるようにコンポーネントを拡張し、正しい金額を表示するように修正。
    *   `GearForm.tsx`: 入力項目のラベルを「購入価格」から「単価 (Unit Price)」に変更し、ユーザーの誤解を防ぐUIに変更。数量入力時の挙動を確認。
*   **売却シート機能の確認・UI保証**:
    *   `ResaleAssistantModal.tsx`: 付属品（元箱、説明書など）のチェックボックスが表示され、選択内容がコピーテキストとPDFに含まれることを確認・保証。
*   **サブスクリプション機能の強化**:
    *   `Subscriptions.tsx`:
        *   カテゴリ入力を選択式から「テキスト入力（サジェスト付き）」に変更し、自由なカテゴリ名に対応。
        *   課金サイクルに「月額」「年額」の選択肢を追加。
        *   開始日入力時に、サイクルに応じて次回支払日（1ヶ月後/1年後）を自動計算するロジックを実装。
*   **バグ報告UIの刷新**:
    *   `BugReportSection.tsx`: 設定画面用の新しいコンポーネントを作成。
    *   `Settings.tsx`: 既存の簡易的なリンクを削除し、視認性の高いカード型UI（オレンジ色のアクセント）に置き換え。Googleフォームへのシステム情報（OS, ブラウザ等）連携導線を整備。

### Ver 1.0.1 - マニュアル整備とバグフィックス (2026-01-28)
*   **ドキュメント作成**:
    *   `INSTRUCTION_MANUAL.md`: アプリケーションの操作説明書を新規作成。
*   **Gear Formの緊急修正**:
    *   以前の変更で消失していた「数量入力フィールド」と「コンテナ化チェックボックス」を再実装し、正常に登録できるように修正。
*   **プロジェクト保全**:
    *   `GearTrace-Full-Ver-1.00-20260128` としてマイルストーンを保存。

### Ver 1.0.0 - Web版デザイン刷新 (2026-01-27)
*   **UIのミニマリズム化**:
    *   `DashboardMetricCard` および `DepreciationCompactCard` のデザインを見直し、数値情報を削減してアイコンとタイトル中心のシンプルなデザインに変更（※今回の1.1.0で、資産価値などの重要数字は再表示するように方針変更）。
*   **開発環境整備**:
    *   Vite + React環境での `npm run dev` 動作確認。

### Legacy Phase (旧Rust/Tauri版からの移行機能)
※ 以下は過去のログに基づく履歴であり、現在のWeb版コードベースの前身となる機能実装です。
*   **CRUD機能の実装**: 機材の追加・更新・削除ロジックの確立。
*   **プロジェクト・支出管理**: 案件ごとの収支管理機能（現在はGearTraceのメイン機能からは分離、または統合中）。
*   **初期セットアップ**: React + TypeScript + Tailwind CSSのプロジェクト構成。

### Code Refactoring & Deduplication (2026-01-30)
*   **コードベースの整理**:
    *   `StatusBadge.tsx` を削除し、より機能的な `SmartStatusBadge.tsx` に統一。
    *   未使用のデッドコード（`exportAllGear` 等）を削除し、メンテナンス性を向上。
    *   Supabase移行に伴い不要となった古いDBコード（`src/db`）を完全に削除。
    *   `package.json` の不要な依存関係（Dexie等）を削除。
